<!DOCTYPE html>
<html>
    <head>
        <script type="module" src="src/tooltipper.js"></script>
        <style>

.tooltip {
    display: grid;
    grid-template-rows: max-content max-content;
    grid-template-columns: max-content;
    background-color: #424242;
    color: #fff;
    border-radius: 2px;
    max-width: 500px;
    max-height: 300px;
    padding: 3px 5px;
    pointer-events: none;
    transform-origin: center;
    z-index: 999;
}

.colorbox {
    display: inline-block;
    height: 12px;
    width: 12px;
    border-radius: 2px;
    box-sizing: border-box;
    border: 1px solid black;
    margin-right: 5px;
}

progress {
    margin-right: 5px;
    text-align: right;
    display: inline-block;
}

.item-name {
    font-weight: bold;
    font-size: 18px;
}

.item {
    box-sizing: border-box;
    display: inline-block;
    position: relative;
    height: 96px;
    width: 96px;
    border: 1px solid black;
    border-radius: 5px;
    background-image: linear-gradient(rgba(47,47,44,1), rgba(106,105,90,1));
}

.item > .icon {
    position: absolute;
    top: 0px;
    left: 0px;
    height: 96px;
    width: 96px;
}

.item > .equipped {
    position: absolute;
    top: 4px;
    left: 4px;
    color: white;
    height: 16px;
    width: 16px;
    image-rendering: -webkit-optimize-contrast;
    background-repeat: no-repeat;
}

.item > .qty {
    position: absolute;
    bottom: 4px;
    right: 8px;
    color: white;
}

.item > .infusion {
    position: absolute;
    height: 24px;
    width: 24px;
    bottom: 4px;
    right: 4px;
    background-color: rgba(47,47,44,1);
    image-rendering: -webkit-optimize-contrast;
}

#character {
    display: grid;
    grid-auto-columns: max-content;
    grid-auto-rows: max-content;
    align-items: start;
    grid-template-areas:
        'stats inventory'
        'equipment inventory'
        'empty inventory'
        'bonfires storage'
        'bonfires storage'
        'flags customization'
        'flags customization';
    grid-gap: 10px;
}

#character-stats {
    grid-area: stats;
    display: grid;
    grid-auto-columns: max-content;
    grid-auto-rows: max-content;
    grid-template-areas: 
        'name empty'
        'statsleft statsright';
    grid-gap: 5px;
}

#character-equipment {
    grid-area: equipment;
    display: grid;
    grid-auto-columns: max-content;
    grid-auto-rows: max-content;
    grid-template-areas: 
        'weapons spells'
        'armor flask'
        'talismans pouch'
        'quick pouch';
    grid-gap: 5px;
}

#character.hide {
    display: none;
}

#character #name {
    grid-area: name;
}

#character #statsLeft {
    grid-area: statsleft;
    display: inline-block;
    vertical-align: top;
}

#character #statsRight {
    grid-area: statsright;
    display: inline-block;
    vertical-align: top;
}

#character #weapons {
    grid-area: weapons;
    display: grid;
    grid-template-rows: repeat(2, 96px);
    grid-template-columns: repeat(5, 96px);
    grid-gap: 2px;
}

#character #armor {
    grid-area: armor;
    display: grid;
    grid-template-rows: repeat(1, 96px);
    grid-template-columns: repeat(4, 96px);
    grid-gap: 2px;
}

#character #equipped-talismans {
    grid-area: talismans;
    display: grid;
    grid-template-rows: repeat(1, 96px);
    grid-template-columns: repeat(4, 96px);
    grid-gap: 2px;
}

#character #equipped-spells {
    grid-area: spells;
    display: grid;
    grid-template-rows: repeat(2, 96px);
    grid-template-columns: repeat(6, 96px);
    grid-gap: 2px;
}

#character #equipped-quick {
    grid-area: quick;
    display: grid;
    grid-template-rows: repeat(2, 96px);
    grid-template-columns: repeat(5, 96px);
    grid-gap: 2px;
}

#character #equipped-flask {
    grid-area: flask;
    display: grid;
    grid-template-rows: repeat(1, 96px);
    grid-template-columns: repeat(2, 96px);
    grid-gap: 2px;
    align-self: end;
}

#character #equipped-pouch {
    grid-area: pouch;
    display: grid;
    grid-template-rows: repeat(3, 96px);
    grid-template-columns: repeat(2, 96px);
    grid-gap: 2px;
    align-self: end;
}

#character #character-inventory {
    display: grid;
    grid-auto-columns: min-content;
    grid-auto-rows: min-content;
    grid-area: inventory;
    grid-gap: 10px;
}

#character #character-storage {
    display: grid;
    grid-auto-columns: min-content;
    grid-auto-rows: min-content;
    grid-area: storage;
    grid-gap: 10px;
}

.tab-select {
    display: grid;
    grid-template-rows: repeat(2, 1fr);
    grid-template-columns: repeat(9, 1fr);
    grid-gap: 4px 7px;
}

.tab-select > .title {
    display: inline-block;
    border-radius: 2px;
    background-color: rgba(50, 50, 50, 1);
    font-size: 16px;
    padding: 2px 5px;
    height: 45px;
    width: 45px;
    color: white;
}

.tab-select > .title.active {
    background-color: rgba(10, 10, 10, 1);
}

.tab-content {
    display: grid;
    grid-auto-columns: max-content;
    grid-auto-rows: max-content;
    grid-gap: 10px;
    max-height: 776px;
    overflow-y: scroll;
}

.tab-content > .tab:not(.active) {
    display: none;
}

.tab-content .tab {
    display: grid;
    grid-auto-columns: max-content;
    grid-auto-rows: max-content;
    grid-gap: 10px;
}

.tab-content .tab .group {
    display: grid;
    grid-template-columns: repeat(5, 96px);
    grid-auto-rows: auto;
    grid-gap: 2px;
}

#character #character-bonfires {
    display: grid;
    grid-auto-columns: min-content;
    grid-auto-rows: min-content;
    grid-area: bonfires;
    grid-gap: 10px;
}

#bonfire-tab-select {
    display: flex;
    flex-wrap: wrap;
    width: 600px;
    gap: 1px;
}

#bonfire-tab-select > .title {
    display: inline-block;
    border-radius: 2px;
    background-color: rgba(100, 100, 100, 1);
    font-size: 16px;
    padding: 2px 5px;
    color: white;
}

#bonfire-tab-select > .title.active {
    font-weight: bold;
}

#bonfire-tab-content {
    display: flex;
    flex-direction: column;
    height: 600px;
    width: 600px;
    overflow-y: scroll;
}

#bonfire-tab-content > .tab:not(.active) {
    display: none;
}

#bonfire-tab-content .tab {
    display: flex;
    flex-direction: column;
}

#bonfire-tab-content .tab .group {
    display: flex;
    flex-direction: column;
    padding-bottom: 5px;
}

#bonfire-tab-content .tab .group .title {
    font-weight: bold;
}

#bonfire-tab-content .tab .group .warp {
    display: flex;
    flex-direction: column;
    font-weight: normal;
}

#character #character-flags {
    display: grid;
    grid-auto-columns: max-content;
    grid-auto-rows: max-content;
    grid-area: flags;
    grid-gap: 10px;
}

#character-customization {
    display: grid;
    grid-auto-columns: max-content;
    grid-auto-rows: max-content;
    grid-area: customization;
    grid-gap: 10px;
}

#character-customization .list {
    position: relative;
    display: grid;
    grid-template-columns: 1fr;
    grid-auto-rows: max-content;
    margin-left: 20px;
    width: 100%;
}

#character-customization .list-item {
    position: relative;
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-auto-rows: max-content;
    width: 100%;
    grid-template-areas:
        'left right';
}

#character-customization .list-item .left {
    position: relative;
    grid-area: left;
    align-self: start;
}

#character-customization .list-item .right {
    position: relative;
    grid-area: right;
    align-self: end;
}

progress::after {
    position: relative;
    content: attr(value);
    right: -30px;
}

#jsonExport {
    position: absolute;
    margin-left: auto;
    margin-right: auto;
    left: 0;
    right: 0;
    bottom: 0;
    top: 0;
    background-color: rgba(0,0,0,0.3);
    z-index: 99999;
}

#jsonExport textarea {
    display: block;
    margin-left: auto;
    margin-right: auto;
    margin-top: 5%;
    height: 80%;
    width: 80%;
}

          </style>
    </head>
    <body>
        <div id="jsonExport" style="display: none;"><textarea></textarea></div>
        <div>
            <input type="file" accept=".sl2">
            <select id="characters" style="display: none;"></select>
            <button id="export" style="display: none;">Export as JSON</button>
        </div>

        <div id="character" class="hide">
            <div id="character-stats">
                <h2 id="name" class="stat" style="margin: 0;"></h2>
                <div id="statsLeft">
                    <div>Level: <span id="stats-runeLevel" class="stat"></span></div>
                    <div>Runes: <span id="stats-runes" class="stat"></span></div>
                    <div>Rune Memory: <span id="stats-runeMemory" class="stat"></span></div>
                    <br/>
                    <div>Vigor: <span id="stats-vigor" class="stat"></span></div>
                    <div>Mind: <span id="stats-mind" class="stat"></span></div>
                    <div>Endurance: <span id="stats-endurance" class="stat"></span></div>
                    <div>Strength: <span id="stats-strength" class="stat"></span></div>
                    <div>Dexterity: <span id="stats-dexterity" class="stat"></span></div>
                    <div>Intelligence: <span id="stats-intelligence" class="stat"></span></div>
                    <div>Faith: <span id="stats-faith" class="stat"></span></div>
                    <div>Arcane: <span id="stats-arcane" class="stat"></span></div>
                </div>
                <div id="statsRight">
                    <div>HP: <span id="stats-maxHealth" class="stat"></span></div>
                    <div>FP: <span id="stats-maxMana" class="stat"></span></div>
                    <div>Stamina: <span id="stats-maxStamina" class="stat"></span></div>
                    <br/>
                    <div>Immunity: <span id="stats-immunity" class="stat"></span></div>
                    <div>Robustness: <span id="stats-robustness" class="stat"></span></div>
                    <div>Vitality: <span id="stats-vitality" class="stat"></span></div>
                    <div>Focus: <span id="stats-focus" class="stat"></span></div>
                </div>
            </div>
            <div id="character-equipment">
                <div id="weapons">
                    <div id="equipped-rightWeapon1" class="stat"></div>
                    <div id="equipped-rightWeapon2" class="stat"></div>
                    <div id="equipped-rightWeapon3" class="stat"></div>
                    <div id="equipped-arrow1" class="stat"></div>
                    <div id="equipped-arrow2" class="stat"></div>
                    <div id="equipped-leftWeapon1" class="stat"></div>
                    <div id="equipped-leftWeapon2" class="stat"></div>
                    <div id="equipped-leftWeapon3" class="stat"></div>
                    <div id="equipped-bolt1" class="stat"></div>
                    <div id="equipped-bolt2" class="stat"></div>
                </div>
                <div id="armor">
                    <div id="equipped-head" class="stat"></div>
                    <div id="equipped-chest" class="stat"></div>
                    <div id="equipped-arms" class="stat"></div>
                    <div id="equipped-legs" class="stat"></div>
                </div>
                <div id="equipped-talismans" class="stat"></div>
                <div id="equipped-quick" class="stat"></div>
                <div id="equipped-spells" class="stat"></div>
                <div id="equipped-pouch" class="stat"></div>
                <div id="equipped-flask" class="stat"></div>
            </div>
            <div id="character-inventory">
                <span class="item-name">Inventory</span>
                <div class="tab-select"></div>
                <div class="tab-content"></div>
            </div>
            <div id="character-bonfires">
                <span class="item-name">Graces</span>
                <div id="bonfire-tab-select"></div>
                <div id="bonfire-tab-content"></div>
            </div>
            <div id="character-storage">
                <span class="item-name">Storage</span>
                <div class="tab-select"></div>
                <div class="tab-content"></div>
            </div>

            <div id="character-flags">
            </div>

            <div id="character-customization">
                <div class="list">
                    <div class="list-item"><span class="left">Age:</span><span id="customization-Age" class="stat"></span></div>
                    <div class="list-item"><span class="left">Alter Skin Color:</span><color id="customization-AlterSkinColor" class="stat"></color></div>
                    <div class="list-item"><span class="left">Alter Face & Hair</span></div>
                    <div class="list">
                        <div class="list-item"><span class="left">Adjust Face Template</span></div>
                        <div class="list">
                            <div class="list-item"><span class="left">Bone Structure:</span><span id="customization-AlterFaceAndHair-FaceTemplate-BoneStructure" class="stat"></span></div>
                            <div class="list-item"><span class="left">Form Emphasis:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceTemplate-FormEmphasis" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">Apparent Age:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceTemplate-ApparentAge" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">Facial Aesthetic:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceTemplate-FacialAesthetic" class="stat"></progress></span></div>
                        </div>
                    </div>
                    <div class="list">
                        <div class="list-item"><span class="left">Face Structure</span></div>
                        <div class="list">
                            <div class="list-item"><span class="left">Facial Balance</span></div>
                            <div class="list">
                                <div class="list-item"><span class="left">Nose Size:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-FacialBalance-NoseSize" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Nose/Forehead Ratio:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-FacialBalance-NoseForeheadRatio" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Face Protrusion:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-FacialBalance-FaceProtrusion" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Vert. Face Ratio:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-FacialBalance-VertFaceRatio" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Facial Feature Slant:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-FacialBalance-FacialFeatureSlant" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Horiz. Face Ratio:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-FacialBalance-HorizFaceRatio" class="stat"></progress></span></div>
                            </div>
                            <div class="list-item"><span class="left">Forehead/Glabella</span></div>
                            <div class="list">
                                <div class="list-item"><span class="left">Forehead Depth:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-ForeheadGlabella-ForeheadDepth" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Forehead Protrusion:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-ForeheadGlabella-ForheadProtrusion" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Nose Bridge Height:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-ForeheadGlabella-NoseBridgeHeight" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Bridge Protrusion 1:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-ForeheadGlabella-BridgeProtrusion1" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Bridge Protrusion 2:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-ForeheadGlabella-BridgeProtrusion2" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Nose Bridge Width:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-ForeheadGlabella-NoseBridgeWidth" class="stat"></progress></span></div>
                            </div>
                            <div class="list-item"><span class="left">Brow Ridge</span></div>
                            <div class="list">
                                <div class="list-item"><span class="left">Brow Ridge Height:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-BrowRidge-BrowRidgeHeight" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Inner Brow Ridge:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-BrowRidge-InnerBrowRidge" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Outer Brow Ridge:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-BrowRidge-OuterBrowRidge" class="stat"></progress></span></div>
                            </div>
                            <div class="list-item"><span class="left">Eyes</span></div>
                            <div class="list">
                                <div class="list-item"><span class="left">Eye Position:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Eyes-EyePosition" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Eye Size:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Eyes-EyeSize" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Eye Slant:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Eyes-EyeSlant" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Eye Spacing:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Eyes-EyeSpacing" class="stat"></progress></span></div>
                            </div>
                            <div class="list-item"><span class="left">Nose Ridge</span></div>
                            <div class="list">
                                <div class="list-item"><span class="left">Nose Ridge Depth:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-NoseRidge-NoseRidgeDepth" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Nose Ridge Length:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-NoseRidge-NoseRidgeLength" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Nose Position:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-NoseRidge-NosePosition" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Nose Tip Height:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-NoseRidge-NoseTipHeight" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Nose Protrusion:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-NoseRidge-NoseProtrusion" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Nose Height:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-NoseRidge-NoseHeight" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Nose Slant:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-NoseRidge-NoseSlant" class="stat"></progress></span></div>
                            </div>
                            <div class="list-item"><span class="left">Nostrils</span></div>
                            <div class="list">
                                <div class="list-item"><span class="left">Nostril Slant:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Nostrils-NostrilSlant" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Nostril Size:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Nostrils-NostrilSize" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Nostril Width:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Nostrils-NostrilWidth" class="stat"></progress></span></div>
                            </div>
                            <div class="list-item"><span class="left">Cheeks</span></div>
                            <div class="list">
                                <div class="list-item"><span class="left">Cheekbone Height:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Cheeks-CheekboneHeight" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Cheekbone Depth:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Cheeks-CheekboneDepth" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Cheekbone Width:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Cheeks-CheekboneWidth" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Cheekbone Protrusion:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Cheeks-CheekboneProtrusion" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Cheeks:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Cheeks-Cheeks" class="stat"></progress></span></div>
                            </div>
                            <div class="list-item"><span class="left">Lips</span></div>
                            <div class="list">
                                <div class="list-item"><span class="left">Lip Shape:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Lips-LipShape" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Mouth Expression:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Lips-MouthExpression" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Lip Fullness:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Lips-LipFullness" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Lip Size:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Lips-LipSize" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Lip Protrusion:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Lips-LipProtrusion" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Lip Thickness:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Lips-LipThickness" class="stat"></progress></span></div>
                            </div>
                            <div class="list-item"><span class="left">Mouth</span></div>
                            <div class="list">
                                <div class="list-item"><span class="left">Mouth Protrusion:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Mouth-MouthProtrusion" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Mouth Slant:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Mouth-MouthSlant" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Occlusion:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Mouth-Occlusion" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Mouth Position:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Mouth-MouthPosition" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Mouth Width:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Mouth-MouthWidth" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Mouth-Chin Distance:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Mouth-MouthChinDistance" class="stat"></progress></span></div>
                            </div>
                            <div class="list-item"><span class="left">Chin</span></div>
                            <div class="list">
                                <div class="list-item"><span class="left">Chin Tip Position:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Chin-ChinTipPosition" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Chin Length:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Chin-ChinLength" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Chin Protrusion:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Chin-ChinProtrusion" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Chin Depth:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Chin-ChinDepth" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Chin Size:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Chin-ChinSize" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Chin Height:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Chin-ChinHeight" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Chin Width:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Chin-ChinWidth" class="stat"></progress></span></div>
                            </div>
                            <div class="list-item"><span class="left">Jaw</span></div>
                            <div class="list">
                                <div class="list-item"><span class="left">Jaw Protrusion:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Jaw-JawProtrusion" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Jaw Width:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Jaw-JawWidth" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Lower Jaw:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Jaw-LowerJaw" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Jaw Contour:</span><span class="right"><progress id="customization-AlterFaceAndHair-FaceStructure-Jaw-JawContour" class="stat"></progress></span></div>
                            </div>
                        </div>
                    </div>
                    <div class="list">
                        <div class="list-item"><span class="left">Hair</span></div>
                        <div class="list">
                            <div class="list-item"><span class="left">Hair:</span><span id="customization-AlterFaceAndHair-Hair-Hair" class="stat"></span></div>
                            <div class="list-item"><span class="left">Hair Color:</span><color id="customization-AlterFaceAndHair-Hair-HairColor" class="stat"></color></div>
                            <div class="list-item"><span class="left">Luster:</span><span class="right"><progress id="customization-AlterFaceAndHair-Hair-Luster" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">Root Darkness:</span><span class="right"><progress id="customization-AlterFaceAndHair-Hair-RootDarkness" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">White Hairs:</span><span class="right"><progress id="customization-AlterFaceAndHair-Hair-WhiteHairs" class="stat"></progress></span></div>
                        </div>
                    </div>
                    <div class="list">
                        <div class="list-item"><span class="left">Eyebrows</span></div>
                        <div class="list">
                            <div class="list-item"><span class="left">Brow:</span><span id="customization-AlterFaceAndHair-Eyebrows-Brow" class="stat"></span></div>
                            <div class="list-item"><span class="left">Brow Color:</span><color id="customization-AlterFaceAndHair-Eyebrows-BrowColor" class="stat"></color></div>
                            <div class="list-item"><span class="left">Luster:</span><span class="right"><progress id="customization-AlterFaceAndHair-Eyebrows-Luster" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">Root Darkness:</span><span class="right"><progress id="customization-AlterFaceAndHair-Eyebrows-RootDarkness" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">White Hairs:</span><span class="right"><progress id="customization-AlterFaceAndHair-Eyebrows-WhiteHairs" class="stat"></progress></span></div>
                        </div>
                    </div>
                    <div class="list">
                        <div class="list-item"><span class="left">Facial Hair</span></div>
                        <div class="list">
                            <div class="list-item"><span class="left">Beard:</span><span id="customization-AlterFaceAndHair-FacialHair-Beard" class="stat"></span></div>
                            <div class="list-item"><span class="left">Beard Color:</span><color id="customization-AlterFaceAndHair-FacialHair-BeardColor" class="stat"></color></div>
                            <div class="list-item"><span class="left">Luster:</span><span class="right"><progress id="customization-AlterFaceAndHair-FacialHair-Luster" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">Root Darkness:</span><span class="right"><progress id="customization-AlterFaceAndHair-FacialHair-RootDarkness" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">White Hairs:</span><span class="right"><progress id="customization-AlterFaceAndHair-FacialHair-WhiteHairs" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">Stubble:</span><span class="right"><progress id="customization-AlterFaceAndHair-FacialHair-Stubble" class="stat"></progress></span></div>
                        </div>
                    </div>
                    <div class="list">
                        <div class="list-item"><span class="left">Eyelashes</span></div>
                        <div class="list">
                            <div class="list-item"><span class="left">Eyelashes:</span><span class="right"><progress id="customization-AlterFaceAndHair-Eyelashes-Eyelashes" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">Eyelash Color:</span><color id="customization-AlterFaceAndHair-Eyelashes-EyelashColor" class="stat"></color></div>
                        </div>
                    </div>
                    <div class="list">
                        <div class="list-item"><span class="left">Eyes</span></div>
                        <div class="list">
                            <div class="list-item"><span class="left">Right Iris Size:</span><span class="right"><progress id="customization-AlterFaceAndHair-Eyes-RightIrisSize" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">Right Iris Color:</span><color id="customization-AlterFaceAndHair-Eyes-RightIrisColor" class="stat"></color></div>
                            <div class="list-item"><span class="left">R Eye Clouding:</span><span class="right"><progress id="customization-AlterFaceAndHair-Eyes-REyeClouding" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">R Clouding Color:</span><color id="customization-AlterFaceAndHair-Eyes-RCloudingColor" class="stat"></color></div>
                            <div class="list-item"><span class="left">R Eye White Color:</span><color id="customization-AlterFaceAndHair-Eyes-REyeWhiteColor" class="stat"></color></div>
                            <div class="list-item"><span class="left">R Eye Position:</span><span class="right"><progress id="customization-AlterFaceAndHair-Eyes-REyePosition" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">Left Iris Size:</span><span class="right"><progress id="customization-AlterFaceAndHair-Eyes-LeftIrisSize" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">Left Iris Color:</span><color id="customization-AlterFaceAndHair-Eyes-LeftIrisColor" class="stat"></color></div>
                            <div class="list-item"><span class="left">L Eye Clouding:</span><span class="right"><progress id="customization-AlterFaceAndHair-Eyes-LEyeClouding" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">L Clouding Color:</span><color id="customization-AlterFaceAndHair-Eyes-LCloudingColor" class="stat"></color></div>
                            <div class="list-item"><span class="left">L Eye White Color:</span><color id="customization-AlterFaceAndHair-Eyes-LEyeWhiteColor" class="stat"></color></div>
                            <div class="list-item"><span class="left">L Eye Position:</span><span class="right"><progress id="customization-AlterFaceAndHair-Eyes-LEyePosition" class="stat"></progress></span></div>
                        </div>
                    </div>
                    <div class="list">
                        <div class="list-item"><span class="left">Skin Features</span></div>
                        <div class="list">
                            <div class="list-item"><span class="left">Pores:</span><span class="right"><progress id="customization-AlterFaceAndHair-SkinFeatures-Pores" class="stat"></progress></span></span></div>
                            <div class="list-item"><span class="left">Skin Luster:</span><span class="right"><progress id="customization-AlterFaceAndHair-SkinFeatures-SkinLuster" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">Dark Circles:</span><span class="right"><progress id="customization-AlterFaceAndHair-SkinFeatures-DarkCircles" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">Dark Circle Color:</span><color id="customization-AlterFaceAndHair-SkinFeatures-DarkCircleColor" class="stat"></color></div>
                        </div>
                    </div>
                    <div class="list">
                        <div class="list-item"><span class="left">Cosmetics</span></div>
                        <div class="list">
                            <div class="list-item"><span class="left">Eyeliner:</span><span class="right"><progress id="customization-AlterFaceAndHair-Cosmetics-Eyeliner" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">Eyeliner Color:</span><color id="customization-AlterFaceAndHair-Cosmetics-EyelinerColor" class="stat"></color></div>
                            <div class="list-item"><span class="left">Eyeshadow (Upper):</span><span class="right"><progress id="customization-AlterFaceAndHair-Cosmetics-EyeshadowUpper" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">Eyeshadow (Upper) Color:</span><color id="customization-AlterFaceAndHair-Cosmetics-EyeshadowUpperColor" class="stat"></color></div>
                            <div class="list-item"><span class="left">Eyeshadow (Lower):</span><span class="right"><progress id="customization-AlterFaceAndHair-Cosmetics-Eyeliner" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">Eyeshadow (Lower) Color:</span><color id="customization-AlterFaceAndHair-Cosmetics-EyeshadowLowerColor" class="stat"></color></div>
                            <div class="list-item"><span class="left">Cheeks Color:</span><color id="customization-AlterFaceAndHair-Cosmetics-CheeksColor" class="stat"></color></div>
                            <div class="list-item"><span class="left">Lipstick:</span><span class="right"><progress id="customization-AlterFaceAndHair-Cosmetics-Lipstick" class="stat"></progress></span></div>
                            <div class="list-item"><span class="left">Lipstick Color:</span><color id="customization-AlterFaceAndHair-Cosmetics-LipstickColor" class="stat"></color></div>
                        </div>
                    </div>
                    <div class="list">
                        <div class="list-item"><span class="left">Tatoo/Mark/Eyepatch</span></div>
                        <div class="list">
                            <div class="list-item"><span class="left">Tattoo/Mark:</span><span id="customization-AlterFaceAndHair-TattooMarkEyepatch-TattooMark" class="stat"></span></div>
                            <div class="list-item"><span class="left">Tattoo/Mark Color:</span><color id="customization-AlterFaceAndHair-TattooMarkEyepatch-TattooMarkColor" class="stat"></color></div>
                            <div class="list-item"><span class="left">Tweak Tattoo/Mark</span></div>
                            <div class="list">
                                <div class="list-item"><span class="left">Position (Vert.):</span><span class="right"><progress id="customization-AlterFaceAndHair-TattooMarkEyepatch-TweakTattooMark-PositionVert" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Position (Horiz.):</span><span class="right"><progress id="customization-AlterFaceAndHair-TattooMarkEyepatch-TweakTattooMark-PositionHoriz" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Angle:</span><span class="right"><progress id="customization-AlterFaceAndHair-TattooMarkEyepatch-TweakTattooMark-Angle" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Expansion:</span><span class="right"><progress id="customization-AlterFaceAndHair-TattooMarkEyepatch-TweakTattooMark-Expansion" class="stat"></progress></span></div>
                                <div class="list-item"><span class="left">Flip:</span><span id="customization-AlterFaceAndHair-TattooMarkEyepatch-TweakTattooMark-Flip" class="stat"></span></div>
                            </div>
                            <div class="list-item"><span class="left">Eyepatch:</span><span id="customization-AlterFaceAndHair-TattooMarkEyepatch-Eyepatch" class="stat"></span></div>
                            <div class="list-item"><span class="left">Eyepatch Color:</span><color id="customization-AlterFaceAndHair-TattooMarkEyepatch-EyepatchColor" class="stat"></color></div>
                        </div>
                    </div>
                    <div class="list-item"><span class="left">Alter Body</span></div>
                    <div class="list">
                        <div class="list-item"><span class="left">Head:</span><span class="right"><progress id="customization-AlterBody-Head" class="stat"></progress></span></div>
                        <div class="list-item"><span class="left">Chest:</span><span class="right"><progress id="customization-AlterBody-Chest" class="stat"></progress></span></div>
                        <div class="list-item"><span class="left">Abdomen:</span><span class="right"><progress id="customization-AlterBody-Abdomen" class="stat"></progress></span></div>
                        <div class="list-item"><span class="left">Arms:</span><span class="right"><progress id="customization-AlterBody-Arms" class="stat"></progress></span></div>
                        <div class="list-item"><span class="left">Legs:</span><span class="right"><progress id="customization-AlterBody-Legs" class="stat"></progress></span></div>
                        <div class="list-item"><span class="left">Body Hair:</span><span class="right"><progress id="customization-AlterBody-BodyHair" class="stat"></progress></span></div>
                        <div class="list-item"><span class="left">Body Hair Color:</span><color id="customization-AlterBody-BodyHairColor" class="stat"></color></div>
                        <div class="list-item"><span class="left">Musculature:</span><span id="customization-AlterBody-Musculature" class="stat"></span></div>
                    </div>
                </div>
            </div>
        </div>

        <script type="module">
            import { SaveData } from './src/savedata.js';
            import lookup from './src/lookup.js'
            import { roundtable_names, build_output } from './src/roundtable_names.js'
            import { roundtable } from './src/roundtable.js'
            import eventFlags from './src/eventflags.js'
            import textLookup from './src/textlookup.js'
            import { bonfires, tabs as bonfireTabs } from './src/bonfires.js'

            window.lookup = lookup;
            window.bonfires = bonfires;
            window.textLookup = textLookup;
            window.roundtable = roundtable;
            window.roundtable_names = roundtable_names;
            window.build_output = build_output;
            window.savedata = null;

            let infusions = {
                0: {
                    name: "Standard",
                    icon: "MENU_FL_40141.png"
                },
                1: {
                    name: "Heavy",
                    icon: "MENU_FL_40142.png"
                },
                2: {
                    name: "Keen",
                    icon: "MENU_FL_40143.png"
                },
                3: {
                    name: "Quality",
                    icon: "MENU_FL_40144.png"
                },
                4: {
                    name: "Fire",
                    icon: "MENU_FL_40148.png"
                },
                5: {
                    name: "Flame Art",
                    icon: "MENU_FL_40148.png"
                },
                6: {
                    name: "Lightning",
                    icon: "MENU_FL_40150.png"
                },
                7: {
                    name: "Sacred",
                    icon: "MENU_FL_40145.png"
                },
                8: {
                    name: "Magic",
                    icon: "MENU_FL_40146.png"
                },
                9: {
                    name: "Cold",
                    icon: "MENU_FL_40147.png"
                },
                10: {
                    name: "Poison",
                    icon: "MENU_FL_40172.png"
                },
                11: {
                    name: "Blood",
                    icon: "MENU_FL_40173.png"
                },
                12: {
                    name: "Occult",
                    icon: "MENU_FL_40151.png"
                }
            }

            function createElement(tagName, options={}) {
                const elem = document.createElement(tagName);
                if (options.className !== undefined)
                    elem.className = options.className;
                if (options.classList !== undefined)
                    elem.classList.add(...options.classList);
                if (options.text !== undefined)
                    elem.textContent = options.text;
                if (options.html !== undefined)
                    elem.innerHTML = options.html;
                if (options.parent !== undefined)
                    options.parent.appendChild(elem);
                if (options.children !== undefined)
                    elem.append(...options.children);
                if (options.style !== undefined)
                    options.style.forEach(([name,value]) => elem.style[name] = value);
                if (options.attributes !== undefined)
                    options.attributes.forEach(([name,value]) => elem.setAttribute(name, value));
                if (options.id !== undefined)
                    elem.id = options.id;
                return elem;
            }

            function exportCharacter() {
                let slot = parseInt(document.querySelector('#characters').value);

                if(slot < 0 || slot > 10)
                    return;

                let character = savedata.characters[slot];

                document.querySelector("#jsonExport textarea").value = JSON.stringify({
                    name: character.name,
                    timePlayed: character.timePlayed,
                    customization: character.customization,
                    equipped: character.equipped,
                    inventory: character.inventory,
                    stats: character.stats,
                    storage: character.storage,
                    flags: character.internal.flags,
                    version: character.version,
                }, null, 2);

                document.querySelector("#jsonExport").style.display = 'block';
            }

            function hidePopup(e) {
                if(e.target == e.currentTarget)
                    document.querySelector("#jsonExport").style.display = 'none';
            }

            function renderCharacter() {
                let slot = parseInt(document.querySelector('#characters').value);

                if(slot < 0 || slot > 10)
                    return;

                let character = savedata.characters[slot];

                let sortGroup = (a,b) => { return a.params.sortId - b.params.sortId; }

                let renderTooltip = (item) => {
                    let tt = `<div class='tooltip'>`;
                    if(item.text.name)
                        tt += `<span class='item-name'>${item.text.name}${item.level > 0 ? ` +${item.level}` : ''}</span>`;
                    if(item.text.info)
                        tt += `<span class='item-info'>${item.text.info}</span>`;
                    if(item.socketedAsh)
                        tt += `<span class='item-socket'>${item.socketedAsh.RowName}</span>`;
                    tt += `</div>`
                    return tt;
                }

                let renderItem = (item, inventory=false, slotName="Empty") => {
                    if(!item || !item.params)
                        return createElement("div", {
                        classList: ['item'],
                        attributes: [
                            ['tooltip', `<div class='tooltip'><span class='item-name'>${slotName}</span></div>`]
                        ]
                    });

                    let icon = createElement("div", {
                        classList: ['item'],
                        attributes: [
                            ['tooltip', renderTooltip(item)]
                        ]
                    });

                    createElement('div', {
                        classList: ['icon'],
                        style: [
                            ['backgroundImage', `url('images/MENU_ItemIcon_${String(item.params.iconId || item.params.iconIdM || item.params.iconIdF).padStart(5, 0)}.png')`],
                            ['backgroundSize', `contain`]
                        ],
                        parent: icon
                    })

                    if(item.equipped && inventory) {
                        createElement('div', {
                            classList: ['equipped'],
                            style: [
                                ['backgroundImage', `url('images/MENU_EquMark.png')`],
                                ['backgroundSize', `contain`]
                            ],
                            parent: icon
                        })
                    }

                    if(item.pouch && inventory) {
                        createElement('div', {
                            classList: ['equipped'],
                            style: [
                                ['backgroundImage', `url('images/MENU_FL_Inv.png')`],
                                ['backgroundSize', `contain`]
                            ],
                            parent: icon
                        })
                    }

                    if(item.spell && inventory) {
                        createElement('div', {
                            classList: ['equipped'],
                            style: [
                                ['backgroundImage', `url('images/MENU_40177_Magic.png')`],
                                ['backgroundSize', `contain`]
                            ],
                            parent: icon
                        })
                    }

                    if(item.flask && inventory) {
                        createElement('div', {
                            classList: ['equipped'],
                            style: [
                                ['backgroundImage', `url('images/MENU_40181_Elixer.png')`],
                                ['backgroundSize', `contain`]
                            ],
                            parent: icon
                        })
                    }

                    if(item.infusion > 0) {
                        createElement('div', {
                            classList: ['infusion'],
                            style: [
                                ['backgroundImage', `url('images/${infusions[item.infusion].icon}')`],
                                ['backgroundSize', `contain`]
                            ],
                            parent: icon
                        })
                    }

                    if(item.qty > 1) {
                        createElement('div', {
                            classList: ['qty'],
                            text: item.qty,
                            parent: icon
                        })
                    }
                    return icon;
                }

                document.getElementById('character').querySelectorAll('.stat').forEach(el => {
                    if(el.id) {
                        let stat = el.id.split('-').reduce((stat, name) => stat[name], character);
                        if(Array.isArray(stat)) {
                            el.innerHTML = '';
                            stat.forEach(item => el.appendChild(renderItem(item)));
                        } else if (typeof stat == "object") {
                            el.innerHTML = '';
                            if(stat.r !== undefined && stat.g !== undefined && stat.b !== undefined) {
                                createElement('span', {
                                    classList: ['colorbox'],
                                    text: ' ',
                                    style: [
                                        ['backgroundColor', `rgb(${stat.r},${stat.g},${stat.b})`]
                                    ],
                                    parent: el
                                })
                                el.appendChild(document.createTextNode(`${stat.r}, ${stat.g}, ${stat.b}`));
                            } else {
                                el.appendChild(renderItem(stat));
                            }
                        } else if(stat !== undefined) {
                            el.innerHTML = '';
                            if(el.nodeName == 'PROGRESS' && !isNaN(parseInt(stat))) {
                                el.max = 255;
                                el.value = parseInt(stat);
                                el.innerHTML = stat;
                            } else {
                                el.innerHTML = stat;
                            }
                        } else {
                            el.innerHTML = '';
                            el.appendChild(renderItem(stat));
                        }
                    }
                })

                let tabs = {};
                tabs.tools = {
                    name: "Tools",
                    inventory: character.inventory.tools,
                    storage: character.storage.tools,
                    icon: "MENU_Tab_00.png"
                };
                tabs.ashes = {
                    name: "Ashes",
                    inventory: character.inventory.ashes,
                    storage: character.storage.ashes,
                    icon: "MENU_Tab_29_Buddy.png"
                };
                tabs.crafting = {
                    name: "Crafting Materials",
                    inventory: character.inventory.crafting,
                    storage: character.storage.crafting,
                    icon: "MENU_Tab_01.png"
                };
                tabs.bolstering = {
                    name: "Bolstering Materials",
                    inventory: character.inventory.bolstering,
                    storage: character.storage.bolstering,
                    icon: "MENU_Tab_19.png"
                };
                tabs.keyitems = {
                    name: "Key Items",
                    inventory: character.inventory.keyitems,
                    storage: character.storage.keyitems,
                    icon: "MENU_Tab_03.png"
                };
                tabs.sorceries = {
                    name: "Sorceries",
                    inventory: character.inventory.sorceries,
                    storage: character.storage.sorceries,
                    icon: "MENU_Tab_30_PyroxeneMagic.png"
                };
                tabs.incantations = {
                    name: "Incantations",
                    inventory: character.inventory.incantations,
                    storage: character.storage.incantations,
                    icon: "MENU_Tab_31_FaithMagic.png"
                };
                tabs.ashofwar = {
                    name: "Ashes of War",
                    inventory: character.inventory.ashofwar,
                    storage: character.storage.ashofwar,
                    icon: "MENU_Tab_32_MagicStone.png"
                };
                tabs.melee = {
                    name: "Melee Armaments",
                    inventory: character.inventory.melee,
                    storage: character.storage.melee,
                    icon: "MENU_Tab_07.png"
                };
                tabs.rangedcatalyst = {
                    name: "Ranged Weapons / Catalysts",
                    inventory: character.inventory.rangedcatalyst,
                    storage: character.storage.rangedcatalyst,
                    icon: "MENU_Tab_08.png"
                };
                tabs.arrowbolts = {
                    name: "Arrows/Bolts",
                    inventory: character.inventory.arrowbolts,
                    storage: character.storage.arrowbolts,
                    icon: "MENU_Tab_14.png"
                };
                tabs.shields = {
                    name: "Shields",
                    inventory: character.inventory.shields,
                    storage: character.storage.shields,
                    icon: "MENU_Tab_09.png"
                };
                tabs.head = {
                    name: "Head",
                    inventory: character.inventory.head,
                    storage: character.storage.head,
                    icon: "MENU_Tab_10.png"
                };
                tabs.chest = {
                    name: "Chest",
                    inventory: character.inventory.chest,
                    storage: character.storage.chest,
                    icon: "MENU_Tab_11.png"
                };
                tabs.arms = {
                    name: "Arms",
                    inventory: character.inventory.arms,
                    storage: character.storage.arms,
                    icon: "MENU_Tab_12.png"
                };
                tabs.legs = {
                    name: "Legs",
                    inventory: character.inventory.legs,
                    storage: character.storage.legs,
                    icon: "MENU_Tab_13.png"
                };
                tabs.talismans = {
                    name: "Talismans",
                    inventory: character.inventory.talismans,
                    storage: character.storage.talismans,
                    icon: "MENU_Tab_15.png"
                };
                tabs.info = {
                    name: "Info",
                    inventory: character.inventory.info,
                    storage: character.storage.info,
                    icon: "MENU_Tab_04.png"
                };


                let fillItems = (parent, type) => {
                    let tabSelect = parent.querySelector('.tab-select');
                    tabSelect.innerHTML = '';
                    let tabContent = parent.querySelector('.tab-content')
                    tabContent.innerHTML = '';

                    Object.entries(tabs).forEach(([id, tab], i) => {
                        let tabTitle = createElement('span', {
                            style: [
                                ['padding', `3px`],
                                ['backgroundImage', `url('images/${tab.icon}')`],
                                ['backgroundSize', `contain`],
                                ['backgroundPosition', 'center'],
                                ['backgroundRepeat', `no-repeat`],
                                ['backgroundOrigin', `content-box`]
                            ],
                        attributes: [
                            ['tooltip', `<div class='tooltip'><div class='item-name'>${tab.name}</div></div>`]
                        ]
                        });
                        tabTitle.classList.add('title');
                        if(i == 0)
                            tabTitle.classList.add('active');

                        tabTitle.addEventListener('click', e => {
                            let selectChildren = [...tabSelect.children];
                            let contentChildren = [...tabContent.children];
                            let oldIndex = selectChildren.findIndex(e => e.classList.contains('active'));
                            let newIndex = selectChildren.indexOf(e.currentTarget);
                            selectChildren[oldIndex].classList.remove('active');
                            contentChildren[oldIndex].classList.remove('active');
                            selectChildren[newIndex].classList.add('active');
                            contentChildren[newIndex].classList.add('active');
                        });
                        tabSelect.appendChild(tabTitle);

                        let tabEl = document.createElement('div');
                        tabEl.classList.add('tab');
                        if(i == 0)
                            tabEl.classList.add('active');
                        
                        let items = new Set(tab[type].map(item => item.params.sortGroupId));
                        Array.from(items).sort((a,b) => a-b).forEach(groupId => {
                            let group = document.createElement('div');
                            group.classList.add('group');
                            tab[type].filter(item => item.params.sortGroupId == groupId).sort(sortGroup).forEach(item => {
                                group.appendChild(renderItem(item, true));
                            })
                            tabEl.appendChild(group);
                        })
                        tabContent.appendChild(tabEl);
                    });
                }

                fillItems(document.getElementById('character-inventory'), 'inventory')
                fillItems(document.getElementById('character-storage'), 'storage')

                
                let bonfireTabSelect = document.getElementById('bonfire-tab-select');
                bonfireTabSelect.innerHTML = '';
                let bonfireTabContent = document.getElementById('bonfire-tab-content')
                bonfireTabContent.innerHTML = '';

                Object.entries(bonfireTabs).sort(([,a],[,b]) => a.sortId-b.sortId).forEach(([id, tab], i) => {
                    let tabTitle = document.createElement('span');
                    tabTitle.classList.add('title');
                    if(i == 0)
                        tabTitle.classList.add('active');

                    tabTitle.appendChild(document.createTextNode(tab.name));
                    tabTitle.addEventListener('click', e => {
                        let selectChildren = [...bonfireTabSelect.children];
                        let contentChildren = [...bonfireTabContent.children];
                        let oldIndex = selectChildren.findIndex(e => e.classList.contains('active'));
                        let newIndex = selectChildren.indexOf(e.target);
                        selectChildren[oldIndex].classList.remove('active');
                        contentChildren[oldIndex].classList.remove('active');
                        selectChildren[newIndex].classList.add('active');
                        contentChildren[newIndex].classList.add('active');
                    });
                    bonfireTabSelect.appendChild(tabTitle);

                    let tabEl = document.createElement('div');
                    tabEl.classList.add('tab');
                    if(i == 0)
                        tabEl.classList.add('active');
                    
                    tab.subcategories.sort((a,b) => a.sortId-b.sortId).forEach(subcat => {
                        if(subcat.bonfires.length == 0)
                            return;
                        let group = document.createElement('div');
                        group.classList.add('group');
                        createElement('div', { className: 'title', text: subcat.name, parent: group });
                        subcat.bonfires.sort((a,b) => a.sortId-b.sortId).forEach(warp => {
                            let found = character.internal.flags[warp.eventFlag];
                            group.appendChild(createElement('div', { html: `${found ? '&#9989;' : '&#10060;'} ${warp.name}` }));
                        })
                        tabEl.appendChild(group);
                    })
                    bonfireTabContent.appendChild(tabEl);
                });

                let flagEl = document.getElementById('character-flags');
                flagEl.innerHTML = '';

                eventFlags.filter(flag => flag.type == "NG" && character.internal.flags[flag.id]).forEach((flag) => createElement('div', {
                    classList: ['flag'],
                    text: `${flag.id} - ${flag.name} = ${character.internal.flags[flag.id]}`,
                    parent: flagEl
                }));
                
                eventFlags.filter(flag => flag.type == "boss_kill" && character.internal.flags[flag.id]).forEach((flag) => createElement('div', {
                    classList: ['flag'],
                    text: `${flag.id} - ${flag.name} = ${character.internal.flags[flag.id]}`,
                    parent: flagEl
                }));

                document.getElementById('character').classList.remove('hide');
            }

            function showFile() {
                let file = document.querySelector('input[type=file]').files[0];
                if(!file)
                    return;
                let reader = new FileReader();
                reader.onload = function (event) {
                    window.savedata = new SaveData(reader.result);
                    console.log(window.savedata);


                    let selectEl = document.querySelector('#characters');
                    while(selectEl.options.length > 0) {                
                        selectEl.remove(0);
                    }

                    for(var i=0; i<savedata.characters.length; i++) {
                        if(savedata.characters[i] !== false && savedata.characters[i].name != "") {
                            let option = document.createElement("option");
                            option.text = savedata.characters[i].name;
                            option.value = i;
                            selectEl.add(option);
                        }
                    }

                    if(selectEl.options.length > 0) {
                        document.getElementById('export').style.display = 'inline-block';
                        selectEl.style.display = 'inline-block';
                        selectEl.value = 0;
                        renderCharacter();
                    } else {
                        selectEl.style.display = 'none';
                        document.getElementById('character').style.display = 'none';
                    }
                }
                reader.readAsArrayBuffer(file);
            }

            document.querySelector('input').addEventListener('change', showFile);
            document.querySelector('#characters').addEventListener('change', renderCharacter);
            document.querySelector('#export').addEventListener('click', exportCharacter);
            document.querySelector('#jsonExport').addEventListener('click', hidePopup);
        </script>
    </body>
</html>